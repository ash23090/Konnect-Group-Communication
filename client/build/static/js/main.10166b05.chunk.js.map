{"version":3,"sources":["socket.js","components/Main/Main.js","components/Video/VideoCard.js","components/BottomBar/BottomBar.js","components/Chat/Chat.js","components/Room/Room.js","App.js","serviceWorker.js","index.js"],"names":["sockets","io","MainContainer","styled","div","Row","Label","label","Input","input","Error","JoinButton","h1","button","Main","props","roomRef","useRef","userRef","useState","err","setErr","errMsg","setErrMsg","useEffect","socket","on","error","roomName","current","value","userName","sessionStorage","setItem","history","push","className","style","fontSize","marginBottom","color","htmlFor","type","id","ref","onClick","emit","roomId","Video","video","VideoCard","peer","stream","srcObject","track","playsInline","autoPlay","Bar","Left","Center","Right","ChatButton","ScreenButton","FaIcon","i","StopButton","CameraButton","SwitchMenu","SwitchList","BottomBar","clickChat","clickCameraDevice","goToBack","toggleCameraAudio","userVideoAudio","clickScreenSharing","screenShare","videoDevices","showVideoDevices","setShowVideoDevices","handleToggle","useCallback","e","state","data-switch","length","map","device","key","deviceId","data-value","audio","ChatContainer","TopHeader","ChatArea","MessageList","Message","UserMessage","BottomInput","Chat","display","currentUser","getItem","msg","setMsg","messagesEndRef","inputRef","sender","msgs","scrollToBottom","scrollIntoView","behavior","idx","float","clear","onKeyUp","target","placeholder","RoomContainer","VideoContainer","VideoAndBarContainer","MyVideo","VideoBox","UserName","Room","peers","setPeers","localUser","setUserVideoAudio","setVideoDevices","displayChat","setDisplayChat","setScreenShare","peersRef","userVideoRef","screenTrackRef","userStream","match","params","findPeer","find","p","peerID","createUserVideo","index","arr","expandScreen","hasOwnProperty","writeUserName","number","navigator","mediaDevices","enumerateDevices","then","devices","filtered","filter","kind","window","addEventListener","getUserMedia","users","forEach","userId","info","caller","Peer","initiator","trickle","signal","userToCall","from","destroy","createPeer","preList","incomingSignal","callerId","to","addPeer","answerId","peerIdx","user","switchTarget","disconnect","preventDefault","leaver","removeItem","location","href","elem","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","muted","playInline","onended","getDisplayMedia","cursor","screenTrack","getTracks","replaceTrack","streams","stopPropagation","event","dataset","enabledAudio","getAudioTracks","enabled","newStreamTrack","oldStreamTrack","removeTrack","addTrack","getAttribute","videoSwitch","audioSwitch","getVideoTracks","userAudioTrack","AppContainer","App","exact","path","component","Boolean","hostname","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"8PAGeA,E,MADCC,GAAG,K,m/CCEnB,IAqEMC,EAAgBC,IAAOC,IAAV,KAKbC,EAAMF,IAAOC,IAAV,KAQHE,EAAQH,IAAOI,MAAV,KAELC,EAAQL,IAAOM,MAAV,KAgBLC,EAAQP,IAAOC,IAAV,KAULO,GAJIR,IAAOS,GAAV,KAIYT,IAAOU,OAAV,MA4BDC,EA1IF,SAACC,GACZ,IAAMC,EAAUC,mBACVC,EAAUD,mBAFM,EAGAE,oBAAS,GAHT,mBAGfC,EAHe,KAGVC,EAHU,OAIMF,mBAAS,IAJf,mBAIfG,EAJe,KAIPC,EAJO,KAiCtB,OA3BAC,qBAAU,WACRC,EAAOC,GAAG,uBAAuB,YAAgB,IAAbC,EAAY,EAAZA,MAClC,GAAKA,EAOHN,EAAOM,GACPJ,EAAU,+BARA,CACV,IAAMK,EAAWZ,EAAQa,QAAQC,MAC3BC,EAAWb,EAAQW,QAAQC,MAEjCE,eAAeC,QAAQ,OAAQF,GAC/BhB,EAAMmB,QAAQC,KAAd,gBAA4BP,UAM/B,CAACb,EAAMmB,UAeR,oCACE,gCACE,wBACEE,UAAU,QACVC,MAAO,CAAEC,SAAU,OAAQC,aAAc,OAAQC,MAAO,UAF1D,WAMA,wBACEJ,UAAU,aACVC,MAAO,CAAEC,SAAU,OAAQC,aAAc,SAF3C,mCAOF,kBAACrC,EAAD,KACE,kBAACG,EAAD,KACE,kBAACC,EAAD,CAAOmC,QAAQ,YACb,0CAEF,kBAACjC,EAAD,CAAOkC,KAAK,OAAOC,GAAG,WAAWC,IAAK5B,KAExC,kBAACX,EAAD,KACE,kBAACC,EAAD,CAAOmC,QAAQ,YACb,0CAEF,kBAACjC,EAAD,CAAOkC,KAAK,OAAOC,GAAG,WAAWC,IAAK1B,KAExC,kBAACP,EAAD,CAAYkC,QAzClB,WACE,IAAMjB,EAAWZ,EAAQa,QAAQC,MAC3BC,EAAWb,EAAQW,QAAQC,MAE5BF,GAAaG,EAIhBN,EAAOqB,KAAK,gBAAiB,CAAEC,OAAQnB,EAAUG,cAHjDV,GAAO,GACPE,EAAU,mCAmCR,UACCH,EAAM,kBAACV,EAAD,KAAQY,GAAkB,Q,8GCjEzC,IAcM0B,EAAQ7C,IAAO8C,MAAV,KAEIC,EAhBG,SAACnC,GACjB,IAAM6B,EAAM3B,mBACNkC,EAAOpC,EAAMoC,KASnB,OAPA3B,qBAAU,WACR2B,EAAKzB,GAAG,UAAU,SAAC0B,GACjBR,EAAIf,QAAQwB,UAAYD,KAE1BD,EAAKzB,GAAG,SAAS,SAAC4B,EAAOF,SACxB,CAACD,IAEG,kBAACH,EAAD,CAAOO,aAAW,EAACC,UAAQ,EAACZ,IAAKA,K,+/FCV1C,IAsFMa,EAAMtD,IAAOC,IAAV,IAUL,IAGEsD,EAAOvD,IAAOC,IAAV,KAMJuD,EAASxD,IAAOC,IAAV,KAMNwD,EAAQzD,IAAOC,IAAV,KAELyD,EAAa1D,IAAOC,IAAV,KAiBV0D,EAAe3D,IAAOC,IAAV,KAiBZ2D,EAAS5D,IAAO6D,EAAV,KAKNC,GAAa9D,IAAOC,IAAV,KAiBV8D,GAAe/D,IAAOC,IAAV,KA2BZ+D,GAAahE,IAAOC,IAAV,KAwBVgE,GAAajE,IAAOC,IAAV,KA+BDiE,GA3PG,SAAC,GAWZ,IAVLC,EAUI,EAVJA,UACAC,EASI,EATJA,kBACAC,EAQI,EARJA,SACAC,EAOI,EAPJA,kBACAC,EAMI,EANJA,eACAC,EAKI,EALJA,mBACAC,EAII,EAJJA,YACAC,EAGI,EAHJA,aACAC,EAEI,EAFJA,iBACAC,EACI,EADJA,oBAEMC,EAAeC,uBACnB,SAACC,GACCH,GAAoB,SAACI,GAAD,OAAYA,OAElC,CAACJ,IAGH,OACE,kBAACtB,EAAD,KACE,kBAACC,EAAD,KACE,kBAACQ,GAAD,CAAcrB,QAAS4B,EAAmBW,cAAY,SACpD,6BACGV,EAAezB,MACd,kBAACc,EAAD,CAAQ3B,UAAU,iBAElB,kBAAC2B,EAAD,CAAQ3B,UAAU,wBALxB,UAUC0C,GACC,kBAACV,GAAD,KACGS,EAAaQ,OAAS,GACrBR,EAAaS,KAAI,SAACC,GAChB,OACE,yBACEC,IAAKD,EAAOE,SACZ5C,QAAS0B,EACTmB,aAAYH,EAAOE,UAElBF,EAAOhF,UAIhB,+CAGJ,kBAAC4D,GAAD,CAAYtB,QAASmC,IAGrB,kBAACd,GAAD,CAAcrB,QAAS4B,EAAmBW,cAAY,SACpD,6BACGV,EAAeiB,MACd,kBAAC5B,EAAD,CAAQ3B,UAAU,sBAElB,kBAAC2B,EAAD,CAAQ3B,UAAU,6BALxB,UAWF,kBAACuB,EAAD,KACE,kBAACE,EAAD,CAAYhB,QAASyB,GACnB,6BACE,kBAACP,EAAD,CAAQ3B,UAAU,qBAFtB,QAMA,kBAAC0B,EAAD,CAAcjB,QAAS8B,GACrB,6BACE,kBAACZ,EAAD,CACE3B,UAAS,yBAAoBwC,EAAc,UAAY,OAH7D,iBASF,kBAAChB,EAAD,KACE,kBAACK,GAAD,CAAYpB,QAAS2B,GAArB,Y,gmEC/ER,IAqEMoB,GAAgBzF,IAAOC,IAAV,MAUbyF,GAAY1F,IAAOC,IAAV,MAQT0F,GAAW3F,IAAOC,IAAV,MAQR2F,GAAc5F,IAAOC,IAAV,MAQX4F,GAAU7F,IAAOC,IAAV,MA4BP6F,GAAc9F,IAAOC,IAAV,MA4BX8F,GAAc/F,IAAOM,MAAV,MAeF0F,GA9KF,SAAC,GAAyB,IAAvBC,EAAsB,EAAtBA,QAASrD,EAAa,EAAbA,OACjBsD,EAAcrE,eAAesE,QAAQ,QADP,EAEdnF,mBAAS,IAFK,mBAE7BoF,EAF6B,KAExBC,EAFwB,KAG9BC,EAAiBxF,iBAAO,MACxByF,EAAWzF,mBAEjBO,qBAAU,WACRC,EAAOC,GAAG,sBAAsB,YAAsB,IAAnB6E,EAAkB,EAAlBA,IAAKI,EAAa,EAAbA,OACtCH,GAAO,SAACI,GAAD,4BAAcA,GAAd,CAAoB,CAAED,SAAQJ,iBAEtC,IAGH/E,qBAAU,WACRqF,MACC,CAACN,IAEJ,IAAMM,EAAiB,WACrBJ,EAAe5E,QAAQiF,eAAe,CAAEC,SAAU,YAcpD,OACE,kBAACnB,GAAD,CAAexD,UAAWgE,EAAU,GAAK,UACvC,kBAACP,GAAD,mBACA,kBAACC,GAAD,KACE,kBAACC,GAAD,KACGQ,GACCA,EAAIjB,KAAI,WAAkB0B,GAAS,IAAxBL,EAAuB,EAAvBA,OAAQJ,EAAe,EAAfA,IAGjB,OAAII,IAAWN,EAEX,kBAACL,GAAD,CAASR,IAAKwB,GACZ,gCAASL,GACT,2BAAIJ,IAKN,kBAACN,GAAD,CAAaT,IAAKwB,GAChB,gCAASL,GACT,2BAAIJ,OAKd,yBAAKlE,MAAO,CAAE4E,MAAO,OAAQC,MAAO,QAAUtE,IAAK6D,MAGvD,kBAACP,GAAD,CACEtD,IAAK8D,EACLS,QAzCc,SAACjC,GACnB,GAAc,UAAVA,EAAEM,IAAiB,CACrB,IAAMe,EAAMrB,EAAEkC,OAAOtF,MAEjByE,IACF9E,EAAOqB,KAAK,kBAAmB,CAAEC,SAAQwD,MAAKI,OAAQN,IACtDK,EAAS7E,QAAQC,MAAQ,MAoCzBuF,YAAY,yB,kvCC3DpB,IAqYMC,GAAgBnH,IAAOC,IAAV,MAObmH,GAAiBpH,IAAOC,IAAV,MAadoH,GAAuBrH,IAAOC,IAAV,MAMpBqH,GAAUtH,IAAO8C,MAAV,MAKPyE,GAAWvH,IAAOC,IAAV,MAmBRuH,GAAWxH,IAAOC,IAAV,MAMR2D,GAAS5D,IAAO6D,EAAV,MAOG4D,GApcF,SAAC7G,GACZ,IAAMsF,EAAcrE,eAAesE,QAAQ,QADrB,EAEInF,mBAAS,IAFb,mBAEf0G,EAFe,KAERC,EAFQ,OAGsB3G,mBAAS,CACnD4G,UAAW,CAAE9E,OAAO,EAAM0C,OAAO,KAJb,mBAGfjB,EAHe,KAGCsD,EAHD,OAMkB7G,mBAAS,IAN3B,mBAMf0D,EANe,KAMDoD,EANC,OAOgB9G,oBAAS,GAPzB,mBAOf+G,EAPe,KAOFC,EAPE,OAQgBhH,oBAAS,GARzB,mBAQfyD,EARe,KAQFwD,EARE,OAS0BjH,oBAAS,GATnC,mBASf2D,EATe,KASGC,EATH,KAUhBsD,EAAWpH,iBAAO,IAClBqH,EAAerH,mBACfsH,EAAiBtH,mBACjBuH,EAAavH,mBACb8B,EAAShC,EAAM0H,MAAMC,OAAO3F,OA+JlC,SAAS4F,EAAShG,GAChB,OAAO0F,EAASxG,QAAQ+G,MAAK,SAACC,GAAD,OAAOA,EAAEC,SAAWnG,KAGnD,SAASoG,EAAgB5F,EAAM6F,EAAOC,GACpC,OACE,kBAACvB,GAAD,CACEtF,UAAS,oBAAeyF,EAAMxC,OAAS,EAAI,GAAKwC,EAAMxC,QACtDxC,QAASqG,EACT1D,IAAKwD,GASX,SAAuBjH,EAAUiH,GAC/B,GAAItE,EAAeyE,eAAepH,KAC3B2C,EAAe3C,GAAUkB,MAC5B,OAAO,kBAAC0E,GAAD,CAAUnC,IAAKzD,GAAWA,GAVhCqH,CAAcjG,EAAKpB,UACpB,kBAAC,GAAD,CAAQK,UAAU,kBAClB,kBAAC,EAAD,CAAWoD,IAAKwD,EAAO7F,KAAMA,EAAMkG,OAAQJ,EAAI5D,UA1KrD7D,qBAAU,WA8GR,OA5GA8H,UAAUC,aAAaC,mBAAmBC,MAAK,SAACC,GAC9C,IAAMC,EAAWD,EAAQE,QAAO,SAACrE,GAAD,MAA4B,eAAhBA,EAAOsE,QACnD5B,EAAgB0B,MAIlBG,OAAOC,iBAAiB,WAAYvF,GAGpC8E,UAAUC,aACPS,aAAa,CAAE/G,OAAO,EAAM0C,OAAO,IACnC8D,MAAK,SAACrG,GACLkF,EAAazG,QAAQwB,UAAYD,EACjCoF,EAAW3G,QAAUuB,EAErB3B,EAAOqB,KAAK,eAAgB,CAAEC,SAAQhB,SAAUsE,IAChD5E,EAAOC,GAAG,gBAAgB,SAACuI,GAEzB,IAAMpC,EAAQ,GACdoC,EAAMC,SAAQ,YAAuB,IAApBC,EAAmB,EAAnBA,OAAQC,EAAW,EAAXA,KACjBrI,EAA2BqI,EAA3BrI,SAAUkB,EAAiBmH,EAAjBnH,MAAO0C,EAAUyE,EAAVzE,MAEvB,GAAI5D,IAAasE,EAAa,CAC5B,IAAMlD,EA2FlB,SAAoBgH,EAAQE,EAAQjH,GAClC,IAAMD,EAAO,IAAImH,IAAK,CACpBC,WAAW,EACXC,SAAS,EACTpH,WAcF,OAXAD,EAAKzB,GAAG,UAAU,SAAC+I,GACjBhJ,EAAOqB,KAAK,eAAgB,CAC1B4H,WAAYP,EACZQ,KAAMN,EACNI,cAGJtH,EAAKzB,GAAG,cAAc,WACpByB,EAAKyH,aAGAzH,EA7GgB0H,CAAWV,EAAQ1I,EAAOkB,GAAIS,GAE3CD,EAAKpB,SAAWA,EAChBoB,EAAK2F,OAASqB,EAEd9B,EAASxG,QAAQM,KAAK,CACpB2G,OAAQqB,EACRhH,OACApB,aAEF8F,EAAM1F,KAAKgB,GAEX6E,GAAkB,SAAC8C,GACjB,OAAO,2BACFA,GADL,kBAEG3H,EAAKpB,SAAW,CAAEkB,QAAO0C,kBAMlCmC,EAASD,MAGXpG,EAAOC,GAAG,mBAAmB,YAA6B,IAA1B+I,EAAyB,EAAzBA,OAAQE,EAAiB,EAAjBA,KAAMP,EAAW,EAAXA,KACtCrI,EAA2BqI,EAA3BrI,SAAUkB,EAAiBmH,EAAjBnH,MAAO0C,EAAUyE,EAAVzE,MAGvB,IAFgBgD,EAASgC,GAEX,CACZ,IAAMxH,EAmFhB,SAAiB4H,EAAgBC,EAAU5H,GACzC,IAAMD,EAAO,IAAImH,IAAK,CACpBC,WAAW,EACXC,SAAS,EACTpH,WAaF,OAVAD,EAAKzB,GAAG,UAAU,SAAC+I,GACjBhJ,EAAOqB,KAAK,iBAAkB,CAAE2H,SAAQQ,GAAID,OAG9C7H,EAAKzB,GAAG,cAAc,WACpByB,EAAKyH,aAGPzH,EAAKsH,OAAOM,GAEL5H,EApGc+H,CAAQT,EAAQE,EAAMvH,GAEnCD,EAAKpB,SAAWA,EAEhBsG,EAASxG,QAAQM,KAAK,CACpB2G,OAAQ6B,EACRxH,OACApB,SAAUA,IAEZ+F,GAAS,SAACmC,GACR,MAAM,GAAN,mBAAWA,GAAX,CAAkB9G,OAEpB6E,GAAkB,SAAC8C,GACjB,OAAO,2BACFA,GADL,kBAEG3H,EAAKpB,SAAW,CAAEkB,QAAO0C,kBAMlClE,EAAOC,GAAG,oBAAoB,YAA2B,IAAxB+I,EAAuB,EAAvBA,OACf9B,EADsC,EAAfwC,UAE/BhI,KAAKsH,OAAOA,MAGtBhJ,EAAOC,GAAG,iBAAiB,YAA2B,IAAxByI,EAAuB,EAAvBA,OACtBiB,GAD6C,EAAfrJ,SACpB4G,EAASwB,IACzBiB,EAAQjI,KAAKyH,UACb9C,GAAS,SAACmC,GAER,OADAA,EAAQA,EAAML,QAAO,SAACyB,GAAD,OAAUA,EAAKvC,SAAWsC,EAAQjI,KAAK2F,UACrD,YAAImB,MAEb5B,EAASxG,QAAUwG,EAASxG,QAAQ+H,QAClC,qBAAGd,SAAwBqB,WAKnC1I,EAAOC,GAAG,oBAAoB,YAA+B,IAA5ByI,EAA2B,EAA3BA,OAAQmB,EAAmB,EAAnBA,aACjCF,EAAUzC,EAASwB,GAEzBnC,GAAkB,SAAC8C,GACjB,IAAI7H,EAAQ6H,EAAQM,EAAQrJ,UAAUkB,MAClC0C,EAAQmF,EAAQM,EAAQrJ,UAAU4D,MAKtC,MAHqB,UAAjB2F,EAA0BrI,GAASA,EAClC0C,GAASA,EAEP,2BACFmF,GADL,kBAEGM,EAAQrJ,SAAW,CAAEkB,QAAO0C,iBAK5B,WACLlE,EAAO8J,gBAGR,IAsEH,IAMM/G,EAAW,SAACU,GAChBA,EAAEsG,iBACF/J,EAAOqB,KAAK,gBAAiB,CAAEC,SAAQ0I,OAAQpF,IAC/CrE,eAAe0J,WAAW,QAC1B5B,OAAO6B,SAASC,KAAO,KA8EnB1C,EAAe,SAAChE,GACpB,IAAM2G,EAAO3G,EAAEkC,OAEXyE,EAAKC,kBACPD,EAAKC,oBACID,EAAKE,qBAEdF,EAAKE,uBACIF,EAAKG,wBAEdH,EAAKG,0BACIH,EAAKI,qBAEdJ,EAAKI,uBA8CT,OACE,kBAAC3E,GAAD,CAAezE,QA3CO,WACjBiC,GAELC,GAAoB,KAyClB,kBAACyC,GAAD,KACE,kBAACD,GAAD,KAEE,kBAACG,GAAD,CACEtF,UAAS,oBAAeyF,EAAMxC,OAAS,EAAI,GAAKwC,EAAMxC,SAErDX,EAAc,UAAczB,MAAQ,KACnC,kBAAC0E,GAAD,KAAWtB,GAEb,kBAAC,GAAD,CAAQjE,UAAU,kBAClB,kBAACqF,GAAD,CACE5E,QAASqG,EACTtG,IAAK0F,EACL4D,OAAK,EACL1I,UAAQ,EACR2I,YAAU,KAIbtE,GACCA,EAAMvC,KAAI,SAACnC,EAAM6F,EAAOC,GAAd,OAAsBF,EAAgB5F,EAAM6F,EAAOC,OAEjE,kBAAC,GAAD,CACEtE,mBA9HmB,WACpBC,EAqCH2D,EAAe1G,QAAQuK,UApCvB9C,UAAUC,aACP8C,gBAAgB,CAAEC,QAAQ,IAC1B7C,MAAK,SAACrG,GACL,IAAMmJ,EAAcnJ,EAAOoJ,YAAY,GAEvCnE,EAASxG,QAAQqI,SAAQ,YAAe,IAAZ/G,EAAW,EAAXA,KAE1BA,EAAKsJ,aACHtJ,EAAKuJ,QAAQ,GACVF,YACA5D,MAAK,SAACtF,GAAD,MAA0B,UAAfA,EAAMuG,QACzB0C,EACA/D,EAAW3G,YAKf0K,EAAYH,QAAU,WACpB/D,EAASxG,QAAQqI,SAAQ,YAAe,IAAZ/G,EAAW,EAAXA,KAC1BA,EAAKsJ,aACHF,EACApJ,EAAKuJ,QAAQ,GACVF,YACA5D,MAAK,SAACtF,GAAD,MAA0B,UAAfA,EAAMuG,QACzBrB,EAAW3G,YAGfyG,EAAazG,QAAQwB,UAAYmF,EAAW3G,QAC5CuG,GAAe,IAGjBE,EAAazG,QAAQwB,UAAYD,EACjCmF,EAAe1G,QAAU0K,EACzBnE,GAAe,OA4Ff9D,UA7KU,SAACY,GACjBA,EAAEyH,kBACFxE,GAAgBD,IA4KV3D,kBA/DkB,SAACqI,GACzB,GACEA,GACAA,EAAMxF,QACNwF,EAAMxF,OAAOyF,SACbD,EAAMxF,OAAOyF,QAAQ/K,MACrB,CACA,IAAM2D,EAAWmH,EAAMxF,OAAOyF,QAAQ/K,MAChCgL,EACJxE,EAAazG,QAAQwB,UAAU0J,iBAAiB,GAAGC,QAErD1D,UAAUC,aACPS,aAAa,CAAE/G,MAAO,CAAEwC,YAAYE,MAAOmH,IAC3CrD,MAAK,SAACrG,GACL,IAAM6J,EAAiB7J,EACpBoJ,YACA5D,MAAK,SAACtF,GAAD,MAA0B,UAAfA,EAAMuG,QACnBqD,EAAiB1E,EAAW3G,QAC/B2K,YACA5D,MAAK,SAACtF,GAAD,MAA0B,UAAfA,EAAMuG,QAEzBrB,EAAW3G,QAAQsL,YAAYD,GAC/B1E,EAAW3G,QAAQuL,SAASH,GAE5B5E,EAASxG,QAAQqI,SAAQ,YAAc,EAAX/G,KAErBsJ,aACHS,EACAD,EACAzE,EAAW3G,iBAmCf2C,SAAUA,EACVC,kBAnKkB,SAACS,GACzB,IAAMkC,EAASlC,EAAEkC,OAAOiG,aAAa,eAErCrF,GAAkB,SAAC8C,GACjB,IAAIwC,EAAcxC,EAAO,UAAc7H,MACnCsK,EAAczC,EAAO,UAAcnF,MAEvC,GAAe,UAAXyB,EAAoB,CAGtBkG,GAAeA,EADbhF,EAAazG,QAAQwB,UAAUmK,iBAAiB,GAEnCR,QAAUM,MACpB,CACL,IAAMG,EACJnF,EAAazG,QAAQwB,UAAU0J,iBAAiB,GAClDQ,GAAeA,EAEXE,EACFA,EAAeT,QAAUO,EAEzB/E,EAAW3G,QAAQkL,iBAAiB,GAAGC,QAAUO,EAIrD,OAAO,2BACFzC,GADL,IAEE/C,UAAW,CAAE9E,MAAOqK,EAAa3H,MAAO4H,QAI5C9L,EAAOqB,KAAK,yBAA0B,CAAEC,SAAQuI,aAAclE,KAsIxD1C,eAAgBA,EAAc,UAC9BE,YAAaA,EACbC,aAAcA,EACdC,iBAAkBA,EAClBC,oBAAqBA,KAGzB,kBAAC,GAAD,CAAMqB,QAAS8B,EAAanF,OAAQA,M,+RCrX1C,IAAM2K,GAAevN,IAAOC,IAAV,MAYHuN,GAzBf,WACE,OACE,kBAAC,IAAD,KACE,kBAACD,GAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOE,OAAK,EAACC,KAAK,IAAIC,UAAWhN,IACjC,kBAAC,IAAD,CAAO8M,OAAK,EAACC,KAAK,gBAAgBC,UAAWlG,SCAnCmG,QACW,cAA7BjE,OAAO6B,SAASqC,UAEe,UAA7BlE,OAAO6B,SAASqC,UAEhBlE,OAAO6B,SAASqC,SAASvF,MACvB,2DCZNwF,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SDuHpB,kBAAmB/E,WACrBA,UAAUgF,cAAcC,MAAM9E,MAAK,SAAA+E,GACjCA,EAAaC,iB","file":"static/js/main.10166b05.chunk.js","sourcesContent":["import io from \"socket.io-client\";\r\n// const sockets = io('http://localhost:3001', { autoConnect: true, forceNew: true });\r\nconst sockets = io(\"/\");\r\nexport default sockets;\r\n","import React, { useRef, useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport socket from \"../../socket\";\r\n\r\nconst Main = (props) => {\r\n  const roomRef = useRef();\r\n  const userRef = useRef();\r\n  const [err, setErr] = useState(false);\r\n  const [errMsg, setErrMsg] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    socket.on(\"FE-error-user-exist\", ({ error }) => {\r\n      if (!error) {\r\n        const roomName = roomRef.current.value;\r\n        const userName = userRef.current.value;\r\n\r\n        sessionStorage.setItem(\"user\", userName);\r\n        props.history.push(`/room/${roomName}`);\r\n      } else {\r\n        setErr(error);\r\n        setErrMsg(\"User name already exist\");\r\n      }\r\n    });\r\n  }, [props.history]);\r\n\r\n  function clickJoin() {\r\n    const roomName = roomRef.current.value;\r\n    const userName = userRef.current.value;\r\n\r\n    if (!roomName || !userName) {\r\n      setErr(true);\r\n      setErrMsg(\"Enter Room Name or User Name\");\r\n    } else {\r\n      socket.emit(\"BE-check-user\", { roomId: roomName, userName });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <header>\r\n        <h1\r\n          className='title'\r\n          style={{ fontSize: \"60px\", marginBottom: \"50px\", color: \"cream\" }}\r\n        >\r\n          Konnect\r\n        </h1>\r\n        <h1\r\n          className='headerText'\r\n          style={{ fontSize: \"40px\", marginBottom: \"40px\" }}\r\n        >\r\n          Communicate without any hassle\r\n        </h1>\r\n      </header>\r\n      <MainContainer>\r\n        <Row>\r\n          <Label htmlFor='roomName'>\r\n            <h1>Room Name</h1>\r\n          </Label>\r\n          <Input type='text' id='roomName' ref={roomRef} />\r\n        </Row>\r\n        <Row>\r\n          <Label htmlFor='userName'>\r\n            <h1>User Name</h1>\r\n          </Label>\r\n          <Input type='text' id='userName' ref={userRef} />\r\n        </Row>\r\n        <JoinButton onClick={clickJoin}> Join </JoinButton>\r\n        {err ? <Error>{errMsg}</Error> : null}\r\n      </MainContainer>\r\n    </>\r\n  );\r\n};\r\n\r\nconst MainContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Row = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  margin-top: 15px;\r\n  line-height: 35px;\r\n`;\r\n\r\nconst Label = styled.label``;\r\n\r\nconst Input = styled.input`\r\n  width: 150px;\r\n  height: 35px;\r\n  margin-left: 15px;\r\n  padding-left: 10px;\r\n  outline: none;\r\n  border: none;\r\n  border-radius: 5px;\r\n\r\n  :focus {\r\n    border: solid 3px #ffa260;\r\n    transform: scale(1.1);\r\n    box-shadow: 0 0.5em 0.5em -0.4em #ffa260;\r\n  }\r\n`;\r\n\r\nconst Error = styled.div`\r\n  margin-top: 10px;\r\n  font-size: 20px;\r\n  color: #e85a71;\r\n`;\r\n// eslint-disable-next-line\r\nconst h = styled.h1`\r\n  font-size: 500px;\r\n  font-weight: bold;\r\n`;\r\nconst JoinButton = styled.button`\r\n \r\n  font-size: 10px;\r\n  font-weight: 500; */\r\n  }\r\n  background:none;\r\n  color: #ffa260;\r\n  \r\n  \r\n  background-color: #000;\r\n  border: solid 2px #ffa260;\r\n  display: block;\r\n  margin: auto;\r\n  margin-top: 20%;\r\n  border-radius: 0.5em;\r\n  padding: 0.7em 2em;\r\n  font-size: 2em;\r\n  transition: all 0.05s;\r\n  :hover {\r\n    transform:scale(1.2);\r\n    box-shadow: 0 0.5em 0.5em -0.4em #ffa260;\r\n    cursor: pointer;\r\n    color: white;\r\n    border-color: #f1ff5c;\r\n    transform: translateY(-0.25em);\r\n  }\r\n`;\r\n\r\nexport default Main;\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport styled from \"styled-components\";\r\nconst VideoCard = (props) => {\r\n  const ref = useRef();\r\n  const peer = props.peer;\r\n\r\n  useEffect(() => {\r\n    peer.on(\"stream\", (stream) => {\r\n      ref.current.srcObject = stream;\r\n    });\r\n    peer.on(\"track\", (track, stream) => {});\r\n  }, [peer]);\r\n\r\n  return <Video playsInline autoPlay ref={ref} />;\r\n};\r\n\r\nconst Video = styled.video``;\r\n\r\nexport default VideoCard;\r\n","import React, { useCallback } from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst BottomBar = ({\r\n  clickChat,\r\n  clickCameraDevice,\r\n  goToBack,\r\n  toggleCameraAudio,\r\n  userVideoAudio,\r\n  clickScreenSharing,\r\n  screenShare,\r\n  videoDevices,\r\n  showVideoDevices,\r\n  setShowVideoDevices,\r\n}) => {\r\n  const handleToggle = useCallback(\r\n    (e) => {\r\n      setShowVideoDevices((state) => !state);\r\n    },\r\n    [setShowVideoDevices]\r\n  );\r\n\r\n  return (\r\n    <Bar>\r\n      <Left>\r\n        <CameraButton onClick={toggleCameraAudio} data-switch='video'>\r\n          <div>\r\n            {userVideoAudio.video ? (\r\n              <FaIcon className='fas fa-video'></FaIcon>\r\n            ) : (\r\n              <FaIcon className='fas fa-video-slash'></FaIcon>\r\n            )}\r\n          </div>\r\n          Camera\r\n        </CameraButton>\r\n        {showVideoDevices && (\r\n          <SwitchList>\r\n            {videoDevices.length > 0 &&\r\n              videoDevices.map((device) => {\r\n                return (\r\n                  <div\r\n                    key={device.deviceId}\r\n                    onClick={clickCameraDevice}\r\n                    data-value={device.deviceId}\r\n                  >\r\n                    {device.label}\r\n                  </div>\r\n                );\r\n              })}\r\n            <div>Switch Camera</div>\r\n          </SwitchList>\r\n        )}\r\n        <SwitchMenu onClick={handleToggle}>\r\n          {/* <i className='fas fa-angle-up'></i> */}\r\n        </SwitchMenu>\r\n        <CameraButton onClick={toggleCameraAudio} data-switch='audio'>\r\n          <div>\r\n            {userVideoAudio.audio ? (\r\n              <FaIcon className='fas fa-microphone'></FaIcon>\r\n            ) : (\r\n              <FaIcon className='fas fa-microphone-slash'></FaIcon>\r\n            )}\r\n          </div>\r\n          Audio\r\n        </CameraButton>\r\n      </Left>\r\n      <Center>\r\n        <ChatButton onClick={clickChat}>\r\n          <div>\r\n            <FaIcon className='fas fa-comments'></FaIcon>\r\n          </div>\r\n          Chat\r\n        </ChatButton>\r\n        <ScreenButton onClick={clickScreenSharing}>\r\n          <div>\r\n            <FaIcon\r\n              className={`fas fa-desktop ${screenShare ? \"sharing\" : \"\"}`}\r\n            ></FaIcon>\r\n          </div>\r\n          Share Screen\r\n        </ScreenButton>\r\n      </Center>\r\n      <Right>\r\n        <StopButton onClick={goToBack}>Leave</StopButton>\r\n      </Right>\r\n    </Bar>\r\n  );\r\n};\r\n\r\nconst Bar = styled.div`\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  width: 100%;\r\n  height: 8%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-weight: 500;\r\n  ${\"\" /* background-color: #9900cc; */}\r\n  background-color:teal;\r\n`;\r\nconst Left = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin-left: 15px;\r\n`;\r\n\r\nconst Center = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Right = styled.div``;\r\n\r\nconst ChatButton = styled.div`\r\n  width: 75px;\r\n  border: none;\r\n  font-size: 0.9375rem;\r\n  padding: 5px;\r\n\r\n  :hover {\r\n    background-color: #9933ff;\r\n    cursor: pointer;\r\n    border-radius: 15px;\r\n  }\r\n\r\n  * {\r\n    pointer-events: none;\r\n  }\r\n`;\r\n\r\nconst ScreenButton = styled.div`\r\n  width: auto;\r\n  border: none;\r\n  font-size: 0.9375rem;\r\n  padding: 5px;\r\n\r\n  :hover {\r\n    background-color: #9933ff;\r\n    cursor: pointer;\r\n    border-radius: 15px;\r\n  }\r\n\r\n  .sharing {\r\n    color: #ee2560;\r\n  }\r\n`;\r\n\r\nconst FaIcon = styled.i`\r\n  width: 30px;\r\n  font-size: calc(16px);\r\n`;\r\n\r\nconst StopButton = styled.div`\r\n  width: 75px;\r\n  height: 30px;\r\n  border: none;\r\n  font-size: 0.9375rem;\r\n  line-height: 30px;\r\n  margin-right: 15px;\r\n  background-color: #ee2560;\r\n  border-radius: 15px;\r\n\r\n  :hover {\r\n    background-color: #f25483;\r\n    cursor: pointer;\r\n    transform: scale(1.1);\r\n  }\r\n`;\r\n\r\nconst CameraButton = styled.div`\r\n  position: relative;\r\n  width: 75px;\r\n  border: none;\r\n  font-size: 0.9375rem;\r\n  padding: 5px;\r\n\r\n  :hover {\r\n    background-color: #9933ff;\r\n    cursor: pointer;\r\n    border-radius: 15px;\r\n    transform: scale(1.1);\r\n  }\r\n\r\n  * {\r\n    pointer-events: none;\r\n  }\r\n\r\n  .fa-microphone-slash {\r\n    color: #ee2560;\r\n  }\r\n\r\n  .fa-video-slash {\r\n    color: #ee2560;\r\n  }\r\n`;\r\n\r\nconst SwitchMenu = styled.div`\r\n  display: flex;\r\n  position: absolute;\r\n  width: 20px;\r\n  top: 7px;\r\n  left: 80px;\r\n  z-index: 1;\r\n\r\n  :hover {\r\n    background-color: #9933ff;\r\n    cursor: pointer;\r\n    border-radius: 15px;\r\n  }\r\n\r\n  * {\r\n    pointer-events: none;\r\n  }\r\n\r\n  > i {\r\n    width: 90%;\r\n    font-size: calc(10px);\r\n  }\r\n`;\r\n\r\nconst SwitchList = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: absolute;\r\n  top: -65.95px;\r\n  left: 80px;\r\n  background-color: #9933ff;\r\n  color: white;\r\n  padding-top: 5px;\r\n  padding-right: 10px;\r\n  padding-bottom: 5px;\r\n  padding-left: 10px;\r\n  text-align: left;\r\n\r\n  > div {\r\n    font-size: 0.85rem;\r\n    padding: 1px;\r\n    margin-bottom: 5px;\r\n\r\n    :not(:last-child):hover {\r\n      background-color: #77b7dd;\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  > div:last-child {\r\n    border-top: 1px solid white;\r\n    cursor: context-menu !important;\r\n  }\r\n`;\r\n\r\nexport default BottomBar;\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport socket from \"../../socket\";\r\n\r\nconst Chat = ({ display, roomId }) => {\r\n  const currentUser = sessionStorage.getItem(\"user\");\r\n  const [msg, setMsg] = useState([]);\r\n  const messagesEndRef = useRef(null);\r\n  const inputRef = useRef();\r\n  //if message is received use useState hook to append the array of msg using spread\r\n  useEffect(() => {\r\n    socket.on(\"FE-receive-message\", ({ msg, sender }) => {\r\n      setMsg((msgs) => [...msgs, { sender, msg }]);\r\n    });\r\n  }, []);\r\n\r\n  // Whenever any new message is received Scroll to Bottom of Message List\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [msg]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n  //sending message\r\n  const sendMessage = (e) => {\r\n    if (e.key === \"Enter\") {\r\n      const msg = e.target.value;\r\n      //if there is something in the message then emit it\r\n      if (msg) {\r\n        socket.emit(\"BE-send-message\", { roomId, msg, sender: currentUser });\r\n        inputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ChatContainer className={display ? \"\" : \"width0\"}>\r\n      <TopHeader>Group Chat</TopHeader>\r\n      <ChatArea>\r\n        <MessageList>\r\n          {msg &&\r\n            msg.map(({ sender, msg }, idx) => {\r\n              //as we will show our message in different color then the message we receive from\r\n              //other users\r\n              if (sender !== currentUser) {\r\n                return (\r\n                  <Message key={idx}>\r\n                    <strong>{sender}</strong>\r\n                    <p>{msg}</p>\r\n                  </Message>\r\n                );\r\n              } else {\r\n                return (\r\n                  <UserMessage key={idx}>\r\n                    <strong>{sender}</strong>\r\n                    <p>{msg}</p>\r\n                  </UserMessage>\r\n                );\r\n              }\r\n            })}\r\n          <div style={{ float: \"left\", clear: \"both\" }} ref={messagesEndRef} />\r\n        </MessageList>\r\n      </ChatArea>\r\n      <BottomInput\r\n        ref={inputRef}\r\n        onKeyUp={sendMessage}\r\n        placeholder='Enter your message'\r\n      />\r\n    </ChatContainer>\r\n  );\r\n};\r\n\r\nconst ChatContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 25%;\r\n  height: 100%;\r\n  background-color: teal;\r\n  transition: all 0.2s ease;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst TopHeader = styled.div`\r\n  width: 100%;\r\n  margin-top: 15px;\r\n  font-weight: 600;\r\n  font-size: 20px;\r\n  color: white;\r\n`;\r\n\r\nconst ChatArea = styled.div`\r\n  width: 100%;\r\n  height: 87.5vh;\r\n  max-height: 83%;\r\n  overflow-x: hidden;\r\n  overflow-y: auto;\r\n`;\r\n\r\nconst MessageList = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n  flex-direction: column;\r\n  padding: 15px;\r\n  color: #252525;\r\n`;\r\n\r\nconst Message = styled.div`\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  font-size: 16px;\r\n  margin-top: 15px;\r\n  margin-left: 15px;\r\n  text-align: left;\r\n\r\n  > strong {\r\n    margin-left: 3px;\r\n  }\r\n\r\n  > p {\r\n    max-width: 65%;\r\n    width: auto;\r\n    padding: 9px;\r\n    margin-top: 3px;\r\n    border: 1px solid rgb(78, 161, 211, 0.3);\r\n    border-radius: 15px;\r\n    box-shadow: 0px 0px 3px #4ea1d3;\r\n    font-size: 14px;\r\n    background-color: blue;\r\n    color: white;\r\n  }\r\n`;\r\n\r\nconst UserMessage = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-end;\r\n  width: 100%;\r\n  font-size: 16px;\r\n  margin-top: 15px;\r\n  text-align: right;\r\n\r\n  > strong {\r\n    margin-right: 35px;\r\n  }\r\n\r\n  > p {\r\n    max-width: 65%;\r\n    width: auto;\r\n    padding: 9px;\r\n    margin-top: 3px;\r\n    margin-right: 30px;\r\n    border: 1px solid rgb(78, 161, 211, 0.3);\r\n    border-radius: 15px;\r\n    background-color: purple;\r\n    color: white;\r\n    font-size: 14px;\r\n    text-align: left;\r\n  }\r\n`;\r\n\r\nconst BottomInput = styled.input`\r\n  bottom: 0;\r\n  width: 100%;\r\n  height: 8%;\r\n  padding: 20px;\r\n  border-top: 1px solid purple;\r\n  box-sizing: border-box;\r\n  opacity: 0.7;\r\n\r\n  :focus {\r\n    outline: none;\r\n    transform: scale(1.1);\r\n  }\r\n`;\r\n\r\nexport default Chat;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Peer from \"simple-peer\";\r\nimport styled from \"styled-components\";\r\nimport socket from \"../../socket\";\r\nimport VideoCard from \"../Video/VideoCard\";\r\nimport BottomBar from \"../BottomBar/BottomBar\";\r\nimport Chat from \"../Chat/Chat\";\r\n\r\nconst Room = (props) => {\r\n  const currentUser = sessionStorage.getItem(\"user\");\r\n  const [peers, setPeers] = useState([]);\r\n  const [userVideoAudio, setUserVideoAudio] = useState({\r\n    localUser: { video: true, audio: true },\r\n  });\r\n  const [videoDevices, setVideoDevices] = useState([]);\r\n  const [displayChat, setDisplayChat] = useState(false);\r\n  const [screenShare, setScreenShare] = useState(false);\r\n  const [showVideoDevices, setShowVideoDevices] = useState(false);\r\n  const peersRef = useRef([]);\r\n  const userVideoRef = useRef();\r\n  const screenTrackRef = useRef();\r\n  const userStream = useRef();\r\n  const roomId = props.match.params.roomId;\r\n\r\n  useEffect(() => {\r\n    // Get Video Devices\r\n    navigator.mediaDevices.enumerateDevices().then((devices) => {\r\n      const filtered = devices.filter((device) => device.kind === \"videoinput\");\r\n      setVideoDevices(filtered);\r\n    });\r\n\r\n    // Set Leave Button Event\r\n    window.addEventListener(\"popstate\", goToBack);\r\n\r\n    // Connect Camera & Mic\r\n    navigator.mediaDevices\r\n      .getUserMedia({ video: true, audio: true })\r\n      .then((stream) => {\r\n        userVideoRef.current.srcObject = stream;\r\n        userStream.current = stream;\r\n\r\n        socket.emit(\"BE-join-room\", { roomId, userName: currentUser });\r\n        socket.on(\"FE-user-join\", (users) => {\r\n          // all users\r\n          const peers = [];\r\n          users.forEach(({ userId, info }) => {\r\n            let { userName, video, audio } = info;\r\n\r\n            if (userName !== currentUser) {\r\n              const peer = createPeer(userId, socket.id, stream);\r\n\r\n              peer.userName = userName;\r\n              peer.peerID = userId;\r\n\r\n              peersRef.current.push({\r\n                peerID: userId,\r\n                peer,\r\n                userName,\r\n              });\r\n              peers.push(peer);\r\n\r\n              setUserVideoAudio((preList) => {\r\n                return {\r\n                  ...preList,\r\n                  [peer.userName]: { video, audio },\r\n                };\r\n              });\r\n            }\r\n          });\r\n\r\n          setPeers(peers);\r\n        });\r\n        //if receive call\r\n        socket.on(\"FE-receive-call\", ({ signal, from, info }) => {\r\n          let { userName, video, audio } = info;\r\n          const peerIdx = findPeer(from);\r\n\r\n          if (!peerIdx) {\r\n            const peer = addPeer(signal, from, stream);\r\n\r\n            peer.userName = userName;\r\n\r\n            peersRef.current.push({\r\n              peerID: from,\r\n              peer,\r\n              userName: userName,\r\n            });\r\n            setPeers((users) => {\r\n              return [...users, peer];\r\n            });\r\n            setUserVideoAudio((preList) => {\r\n              return {\r\n                ...preList,\r\n                [peer.userName]: { video, audio },\r\n              };\r\n            });\r\n          }\r\n        });\r\n        //if call is accepted\r\n        socket.on(\"FE-call-accepted\", ({ signal, answerId }) => {\r\n          const peerIdx = findPeer(answerId);\r\n          peerIdx.peer.signal(signal);\r\n        });\r\n        //if user leaves\r\n        socket.on(\"FE-user-leave\", ({ userId, userName }) => {\r\n          const peerIdx = findPeer(userId);\r\n          peerIdx.peer.destroy();\r\n          setPeers((users) => {\r\n            users = users.filter((user) => user.peerID !== peerIdx.peer.peerID);\r\n            return [...users];\r\n          });\r\n          peersRef.current = peersRef.current.filter(\r\n            ({ peerID }) => peerID !== userId\r\n          );\r\n        });\r\n      });\r\n    //if camera is switched on\r\n    socket.on(\"FE-toggle-camera\", ({ userId, switchTarget }) => {\r\n      const peerIdx = findPeer(userId);\r\n\r\n      setUserVideoAudio((preList) => {\r\n        let video = preList[peerIdx.userName].video;\r\n        let audio = preList[peerIdx.userName].audio;\r\n\r\n        if (switchTarget === \"video\") video = !video;\r\n        else audio = !audio;\r\n\r\n        return {\r\n          ...preList,\r\n          [peerIdx.userName]: { video, audio },\r\n        };\r\n      });\r\n    });\r\n\r\n    return () => {\r\n      socket.disconnect();\r\n    };\r\n    // eslint-disable-next-line\r\n  }, []);\r\n  //function for creating peer\r\n  function createPeer(userId, caller, stream) {\r\n    const peer = new Peer({\r\n      initiator: true,\r\n      trickle: false,\r\n      stream,\r\n    });\r\n\r\n    peer.on(\"signal\", (signal) => {\r\n      socket.emit(\"BE-call-user\", {\r\n        userToCall: userId,\r\n        from: caller,\r\n        signal,\r\n      });\r\n    });\r\n    peer.on(\"disconnect\", () => {\r\n      peer.destroy();\r\n    });\r\n\r\n    return peer;\r\n  }\r\n  //function for adding peer\r\n  function addPeer(incomingSignal, callerId, stream) {\r\n    const peer = new Peer({\r\n      initiator: false,\r\n      trickle: false,\r\n      stream,\r\n    });\r\n\r\n    peer.on(\"signal\", (signal) => {\r\n      socket.emit(\"BE-accept-call\", { signal, to: callerId });\r\n    });\r\n\r\n    peer.on(\"disconnect\", () => {\r\n      peer.destroy();\r\n    });\r\n\r\n    peer.signal(incomingSignal);\r\n\r\n    return peer;\r\n  }\r\n\r\n  function findPeer(id) {\r\n    return peersRef.current.find((p) => p.peerID === id);\r\n  }\r\n\r\n  function createUserVideo(peer, index, arr) {\r\n    return (\r\n      <VideoBox\r\n        className={`width-peer${peers.length > 8 ? \"\" : peers.length}`}\r\n        onClick={expandScreen}\r\n        key={index}\r\n      >\r\n        {writeUserName(peer.userName)}\r\n        <FaIcon className='fas fa-expand' />\r\n        <VideoCard key={index} peer={peer} number={arr.length} />\r\n      </VideoBox>\r\n    );\r\n  }\r\n  //checks if the uservideoaudio has a property of user if not\r\n  function writeUserName(userName, index) {\r\n    if (userVideoAudio.hasOwnProperty(userName)) {\r\n      if (!userVideoAudio[userName].video) {\r\n        return <UserName key={userName}>{userName}</UserName>;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Open Chat\r\n  const clickChat = (e) => {\r\n    e.stopPropagation();\r\n    setDisplayChat(!displayChat);\r\n  };\r\n\r\n  // BackButton\r\n  const goToBack = (e) => {\r\n    e.preventDefault();\r\n    socket.emit(\"BE-leave-room\", { roomId, leaver: currentUser });\r\n    sessionStorage.removeItem(\"user\");\r\n    window.location.href = \"/\";\r\n  };\r\n  //toggling audio\r\n  const toggleCameraAudio = (e) => {\r\n    const target = e.target.getAttribute(\"data-switch\");\r\n\r\n    setUserVideoAudio((preList) => {\r\n      let videoSwitch = preList[\"localUser\"].video;\r\n      let audioSwitch = preList[\"localUser\"].audio;\r\n\r\n      if (target === \"video\") {\r\n        const userVideoTrack =\r\n          userVideoRef.current.srcObject.getVideoTracks()[0];\r\n        videoSwitch = !videoSwitch;\r\n        userVideoTrack.enabled = videoSwitch;\r\n      } else {\r\n        const userAudioTrack =\r\n          userVideoRef.current.srcObject.getAudioTracks()[0];\r\n        audioSwitch = !audioSwitch;\r\n\r\n        if (userAudioTrack) {\r\n          userAudioTrack.enabled = audioSwitch;\r\n        } else {\r\n          userStream.current.getAudioTracks()[0].enabled = audioSwitch;\r\n        }\r\n      }\r\n\r\n      return {\r\n        ...preList,\r\n        localUser: { video: videoSwitch, audio: audioSwitch },\r\n      };\r\n    });\r\n\r\n    socket.emit(\"BE-toggle-camera-audio\", { roomId, switchTarget: target });\r\n  };\r\n  //screen share\r\n  const clickScreenSharing = () => {\r\n    if (!screenShare) {\r\n      navigator.mediaDevices\r\n        .getDisplayMedia({ cursor: true })\r\n        .then((stream) => {\r\n          const screenTrack = stream.getTracks()[0];\r\n\r\n          peersRef.current.forEach(({ peer }) => {\r\n            // replaceTrack (oldTrack, newTrack, oldStream);\r\n            peer.replaceTrack(\r\n              peer.streams[0]\r\n                .getTracks()\r\n                .find((track) => track.kind === \"video\"),\r\n              screenTrack,\r\n              userStream.current\r\n            );\r\n          });\r\n\r\n          // Listen click end\r\n          screenTrack.onended = () => {\r\n            peersRef.current.forEach(({ peer }) => {\r\n              peer.replaceTrack(\r\n                screenTrack,\r\n                peer.streams[0]\r\n                  .getTracks()\r\n                  .find((track) => track.kind === \"video\"),\r\n                userStream.current\r\n              );\r\n            });\r\n            userVideoRef.current.srcObject = userStream.current;\r\n            setScreenShare(false);\r\n          };\r\n\r\n          userVideoRef.current.srcObject = stream;\r\n          screenTrackRef.current = screenTrack;\r\n          setScreenShare(true);\r\n        });\r\n    } else {\r\n      screenTrackRef.current.onended();\r\n    }\r\n  };\r\n  //expand screen\r\n  const expandScreen = (e) => {\r\n    const elem = e.target;\r\n\r\n    if (elem.requestFullscreen) {\r\n      elem.requestFullscreen();\r\n    } else if (elem.mozRequestFullScreen) {\r\n      /* for Firefox */\r\n      elem.mozRequestFullScreen();\r\n    } else if (elem.webkitRequestFullscreen) {\r\n      /* for Chrome, Safari & Opera */\r\n      elem.webkitRequestFullscreen();\r\n    } else if (elem.msRequestFullscreen) {\r\n      /* IE/Edge */\r\n      elem.msRequestFullscreen();\r\n    }\r\n  };\r\n\r\n  const clickBackground = () => {\r\n    if (!showVideoDevices) return;\r\n\r\n    setShowVideoDevices(false);\r\n  };\r\n\r\n  const clickCameraDevice = (event) => {\r\n    if (\r\n      event &&\r\n      event.target &&\r\n      event.target.dataset &&\r\n      event.target.dataset.value\r\n    ) {\r\n      const deviceId = event.target.dataset.value;\r\n      const enabledAudio =\r\n        userVideoRef.current.srcObject.getAudioTracks()[0].enabled;\r\n\r\n      navigator.mediaDevices\r\n        .getUserMedia({ video: { deviceId }, audio: enabledAudio })\r\n        .then((stream) => {\r\n          const newStreamTrack = stream\r\n            .getTracks()\r\n            .find((track) => track.kind === \"video\");\r\n          const oldStreamTrack = userStream.current\r\n            .getTracks()\r\n            .find((track) => track.kind === \"video\");\r\n\r\n          userStream.current.removeTrack(oldStreamTrack);\r\n          userStream.current.addTrack(newStreamTrack);\r\n\r\n          peersRef.current.forEach(({ peer }) => {\r\n            // replaceTrack (oldTrack, newTrack, oldStream);\r\n            peer.replaceTrack(\r\n              oldStreamTrack,\r\n              newStreamTrack,\r\n              userStream.current\r\n            );\r\n          });\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <RoomContainer onClick={clickBackground}>\r\n      <VideoAndBarContainer>\r\n        <VideoContainer>\r\n          {/* Current User Video */}\r\n          <VideoBox\r\n            className={`width-peer${peers.length > 8 ? \"\" : peers.length}`}\r\n          >\r\n            {userVideoAudio[\"localUser\"].video ? null : (\r\n              <UserName>{currentUser}</UserName>\r\n            )}\r\n            <FaIcon className='fas fa-expand' />\r\n            <MyVideo\r\n              onClick={expandScreen}\r\n              ref={userVideoRef}\r\n              muted\r\n              autoPlay\r\n              playInline\r\n            ></MyVideo>\r\n          </VideoBox>\r\n          {/* Joined User Video */}\r\n          {peers &&\r\n            peers.map((peer, index, arr) => createUserVideo(peer, index, arr))}\r\n        </VideoContainer>\r\n        <BottomBar\r\n          clickScreenSharing={clickScreenSharing}\r\n          clickChat={clickChat}\r\n          clickCameraDevice={clickCameraDevice}\r\n          goToBack={goToBack}\r\n          toggleCameraAudio={toggleCameraAudio}\r\n          userVideoAudio={userVideoAudio[\"localUser\"]}\r\n          screenShare={screenShare}\r\n          videoDevices={videoDevices}\r\n          showVideoDevices={showVideoDevices}\r\n          setShowVideoDevices={setShowVideoDevices}\r\n        />\r\n      </VideoAndBarContainer>\r\n      <Chat display={displayChat} roomId={roomId} />\r\n    </RoomContainer>\r\n  );\r\n};\r\n//styles\r\nconst RoomContainer = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n  max-height: 100vh;\r\n  flex-direction: row;\r\n`;\r\n\r\nconst VideoContainer = styled.div`\r\n  max-width: 100%;\r\n  height: 92%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-evenly;\r\n  flex-wrap: wrap;\r\n  align-items: center;\r\n  padding: 15px;\r\n  box-sizing: border-box;\r\n  gap: 10px;\r\n`;\r\n\r\nconst VideoAndBarContainer = styled.div`\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100vh;\r\n`;\r\n\r\nconst MyVideo = styled.video`\r\n  width: 20vw;\r\n  height: 20vh;\r\n`;\r\n\r\nconst VideoBox = styled.div`\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  > video {\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  :hover {\r\n    > i {\r\n      display: block;\r\n    }\r\n  }\r\n`;\r\n\r\nconst UserName = styled.div`\r\n  position: absolute;\r\n  font-size: calc(20px);\r\n  z-index: 1;\r\n`;\r\n\r\nconst FaIcon = styled.i`\r\n  display: none;\r\n  position: absolute;\r\n  right: 15px;\r\n  top: 15px;\r\n`;\r\n\r\nexport default Room;\r\n","import React from \"react\";\r\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\r\nimport Main from \"./components/Main/Main\";\r\nimport Room from \"./components/Room/Room\";\r\nimport styled from \"styled-components\";\r\n\r\nfunction App() {\r\n  return (\r\n    <BrowserRouter>\r\n      <AppContainer>\r\n        <Switch>\r\n          <Route exact path='/' component={Main} />\r\n          <Route exact path='/room/:roomId' component={Room} />\r\n        </Switch>\r\n      </AppContainer>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nconst AppContainer = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100vh;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: calc(8px);\r\n  color: white;\r\n  background-color: #252525;\r\n  text-align: center;\r\n`;\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}